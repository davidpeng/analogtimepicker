function AnalogTimePicker(e,t,i){this.$element_=e,this.$element_.className+=" analogtimepicker-container",this.hour_="undefined"!=typeof t?t:0,this.minute_="undefined"!=typeof i?i:0,this.width_=this.$element_.offsetWidth,this.height_=this.$element_.offsetHeight,this.largeFontSize_=this.height_/6,this.smallFontSize_=this.largeFontSize_/3,this.optionFontSize_=this.height_/14,this.tapped_=!1,this.beforeChangeTimeHandler_=function(){},this.afterChangeTimeHandler_=function(){},this.beforeSwitchModeHandler_=function(){},this.afterSwitchModeHandler_=function(){};var o=document.createElement("div");o.className="analogtimepicker-time",this.$element_.appendChild(o),this.$hour_=document.createElement("div"),this.$hour_.textContent="12",this.$hour_.style.cursor="pointer",this.$hour_.style.display="inline-block",this.$hour_.style.fontSize=this.largeFontSize_+"px",this.$hour_.style.textAlign="right",this.$hour_.className="analogtimepicker-selected",o.appendChild(this.$hour_),this.$hour_.style.width=this.$hour_.offsetWidth+"px",this.$hour_.textContent=this.getDisplayHour_(this.hour_);var n=document.createElement("span");n.textContent=":",n.style.fontSize=this.largeFontSize_+"px",o.appendChild(n),this.$minute_=document.createElement("span"),this.$minute_.textContent=this.getDisplayMinute_(this.minute_),this.$minute_.style.cursor="pointer",this.$minute_.style.fontSize=this.largeFontSize_+"px",o.appendChild(this.$minute_),this.$amPm_=document.createElement("span"),this.$amPm_.textContent=this.getDisplayAmPm_(this.hour_),this.$amPm_.style.cursor="pointer",this.$amPm_.style.fontSize=this.smallFontSize_+"px",o.appendChild(this.$amPm_),this.$hour_.style.marginLeft=(o.offsetWidth-this.$hour_.offsetWidth-n.offsetWidth-this.$minute_.offsetWidth-this.$amPm_.offsetWidth)/2+"px";var s=document.createElement("div");s.textContent="00",s.style.fontSize=this.optionFontSize_+"px",this.$element_.appendChild(s);var r=s.offsetWidth,a=s.offsetHeight;this.$element_.removeChild(s),this.clockCenterX_=this.width_/2,this.clockCenterY_=this.$hour_.offsetHeight+(this.height_-this.$hour_.offsetHeight-a)/2,this.clockRadius_=Math.min(this.width_/2-r,(this.height_-this.$hour_.offsetHeight-a)/2-a);var h=document.createElement("div");for(h.className="analogtimepicker-clock",h.style.left=this.clockCenterX_-this.clockRadius_-.9*r+"px",h.style.top=this.clockCenterY_-this.clockRadius_-.9*r+"px",h.style.width=2*this.clockRadius_+1.8*r+"px",h.style.height=2*this.clockRadius_+1.8*r+"px",this.$element_.appendChild(h),this.$hourOptions_=[],t=0;12>t;t++)s=document.createElement("div"),s.textContent=this.getDisplayHour_(t),s.style.fontSize=this.optionFontSize_+"px",this.$element_.appendChild(s),this.positionAtAngle_(s,this.getAngleAtHour_(t)),this.$hourOptions_.push(s);for(this.$minuteOptions_=[],i=0;60>i;i+=5)s=document.createElement("div"),s.textContent=this.getDisplayMinute_(i),s.style.fontSize=this.optionFontSize_+"px",this.$element_.appendChild(s),this.positionAtAngle_(s,this.getAngleAtMinute_(i)),s.style.display="none",this.$minuteOptions_.push(s);this.$am_=document.createElement("div"),this.$am_.textContent="AM",this.$am_.style.cursor="pointer",this.$am_.style.fontSize=this.optionFontSize_+"px",this.$element_.appendChild(this.$am_),this.$am_.style.left=this.clockCenterX_-this.clockRadius_-r/2+"px",this.$am_.style.top=this.clockCenterY_+this.clockRadius_+a/2+"px",this.$pm_=document.createElement("div"),this.$pm_.textContent="PM",this.$pm_.style.cursor="pointer",this.$pm_.style.fontSize=this.optionFontSize_+"px",this.$element_.appendChild(this.$pm_),this.$pm_.style.left=this.clockCenterX_+this.clockRadius_-this.$pm_.offsetWidth+r/2+"px",this.$pm_.style.top=this.clockCenterY_+this.clockRadius_+a/2+"px",this.selectionSize_=Math.max(this.$am_.offsetWidth,this.$am_.offsetHeight),this.$clockSelection_=document.createElement("div"),this.$clockSelection_.className="analogtimepicker-selection",this.$clockSelection_.style.width=this.selectionSize_+"px",this.$clockSelection_.style.height=this.selectionSize_+"px",this.$element_.appendChild(this.$clockSelection_),this.positionClockSelection_(),this.$hoverSelection_=document.createElement("div"),this.$hoverSelection_.className="analogtimepicker-hover-selection",this.$hoverSelection_.style.width=this.selectionSize_/3+"px",this.$hoverSelection_.style.height=this.selectionSize_/3+"px",this.$hoverSelection_.style.display="none",this.$element_.appendChild(this.$hoverSelection_),this.$amPmSelection_=document.createElement("div"),this.$amPmSelection_.className="analogtimepicker-selection",this.$amPmSelection_.style.width=1.2*this.selectionSize_+"px",this.$amPmSelection_.style.height=1.2*this.selectionSize_+"px",this.$element_.appendChild(this.$amPmSelection_),this.$amPmSelection_.style.top=this.$am_.offsetTop-(1.2*this.selectionSize_-this.$am_.offsetHeight)/2+"px",this.positionAmPmSelection_(),this.attachEventHandlers_()}AnalogTimePicker.prototype.getDisplayHour_=function(e){var t=e%12;return 0===t?12:t},AnalogTimePicker.prototype.getDisplayMinute_=function(e){return 1==e.toString().length?"0"+e:e},AnalogTimePicker.prototype.getDisplayAmPm_=function(e){return 12>e?"AM":"PM"},AnalogTimePicker.prototype.positionAtAngle_=function(e,t){e.style.left=this.clockCenterX_+this.clockRadius_*Math.cos(t)-e.offsetWidth/2+"px",e.style.top=this.clockCenterY_+this.clockRadius_*Math.sin(t)-e.offsetHeight/2+"px"},AnalogTimePicker.prototype.getAngleAtHour_=function(e){return e/12*2*Math.PI-Math.PI/2},AnalogTimePicker.prototype.getAngleAtMinute_=function(e){return e/60*2*Math.PI-Math.PI/2},AnalogTimePicker.prototype.positionClockSelection_=function(){var e="analogtimepicker-selected"==this.$hour_.className?this.getAngleAtHour_(this.hour_):this.getAngleAtMinute_(this.minute_);this.positionAtAngle_(this.$clockSelection_,e)},AnalogTimePicker.prototype.positionHoverSelection_=function(e){var t="analogtimepicker-selected"==this.$hour_.className?this.getAngleAtHour_(e):this.getAngleAtMinute_(e);this.positionAtAngle_(this.$hoverSelection_,t)},AnalogTimePicker.prototype.positionAmPmSelection_=function(){var e=this.hour_<12?this.$am_:this.$pm_;this.$amPmSelection_.style.left=e.offsetLeft-(1.2*this.selectionSize_-e.offsetWidth)/2+"px"},AnalogTimePicker.prototype.attachEventHandlers_=function(){var e=this;e.$hour_.addEventListener("click",function(){e.switchToChangeHourMode_()}),e.$minute_.addEventListener("click",function(){e.switchToChangeMinuteMode_()}),e.$amPm_.addEventListener("click",function(){var t=(e.hour_+12)%24;e.beforeChangeTimeHandler_(t,this.minute_)!==!1&&(e.hour_=t,e.$amPm_.textContent=e.getDisplayAmPm_(e.hour_),e.positionAmPmSelection_(),e.afterChangeTimeHandler_())}),e.$element_.addEventListener("mousemove",function(t){var i=e.getClockCoordinates_(t);e.handleMouseMove_(i)}),e.$element_.addEventListener("click",function(t){var i=e.getClockCoordinates_(t);e.handleMouseUp_(i)}),e.$element_.addEventListener("touchstart",function(t){var i=e.getClockCoordinates_(t.touches[0]);if(e.isOverClockOption_(i)){t.preventDefault(),e.tapped_=!0;var o=function(t){document.removeEventListener("touchend",o);var i=e.getClockCoordinates_(t.changedTouches[0]);e.handleMouseUp_(i),e.tapped_=!1};document.addEventListener("touchend",o)}}),e.$element_.addEventListener("touchmove",function(t){e.tapped_=!1;var i=e.getClockCoordinates_(t.touches[0]);e.handleMouseMove_(i)}),e.$am_.addEventListener("click",function(){if(e.hour_>=12){var t=e.hour_-12;e.beforeChangeTimeHandler_(t,this.minute_)!==!1&&(e.hour_=t,e.$amPm_.textContent=e.getDisplayAmPm_(e.hour_),e.positionAmPmSelection_(),e.afterChangeTimeHandler_())}}),e.$pm_.addEventListener("click",function(){if(e.hour_<12){var t=e.hour_+12;e.beforeChangeTimeHandler_(t,this.minute_)!==!1&&(e.hour_=t,e.$amPm_.textContent=e.getDisplayAmPm_(e.hour_),e.positionAmPmSelection_(),e.afterChangeTimeHandler_())}})},AnalogTimePicker.prototype.handleMouseMove_=function(e){if(this.isOverClockOption_(e)){var t=this.getAngleAtCoordinates_(e);if("analogtimepicker-selected"==this.$hour_.className){var i=this.getHourAtAngle_(t);this.$hour_.textContent=this.getDisplayHour_(i),this.positionHoverSelection_(i)}else{var o=this.getMinuteAtAngle_(t);this.$minute_.textContent=this.getDisplayMinute_(o),this.positionHoverSelection_(o)}this.$hoverSelection_.style.display="block",this.$element_.style.cursor="pointer"}else"analogtimepicker-selected"==this.$hour_.className?this.$hour_.textContent=this.getDisplayHour_(this.hour_):this.$minute_.textContent=this.getDisplayMinute_(this.minute_),this.$hoverSelection_.style.display="none",this.$element_.style.cursor="auto"},AnalogTimePicker.prototype.handleMouseUp_=function(e){if(this.isOverClockOption_(e)){var t=this.getAngleAtCoordinates_(e);if("analogtimepicker-selected"==this.$hour_.className){var i=12*Math.floor(this.hour_/12)+this.getHourAtAngle_(t);this.hour_!=i&&this.beforeChangeTimeHandler_(i,this.minute_)!==!1&&(this.hour_=i,this.$hour_.textContent=this.getDisplayHour_(this.hour_),this.afterChangeTimeHandler_()),this.switchToChangeMinuteMode_()}else{var o=this.getMinuteAtAngle_(t);this.minute_!=o&&this.beforeChangeTimeHandler_(this.hour_,o)!==!1&&(this.minute_=o,this.$minute_.textContent=this.getDisplayMinute_(this.minute_),this.positionClockSelection_(),this.afterChangeTimeHandler_())}this.$hoverSelection_.style.display="none"}},AnalogTimePicker.prototype.getClockCoordinates_=function(e){var t=this.$element_.getBoundingClientRect(),i=t.left+document.body.scrollLeft,o=t.top+document.body.scrollTop;return{x:e.pageX-i-this.clockCenterX_,y:e.pageY-o-this.clockCenterY_}},AnalogTimePicker.prototype.isOverClockOption_=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return Math.abs(t-this.clockRadius_)<this.selectionSize_/2},AnalogTimePicker.prototype.getAngleAtCoordinates_=function(e){return Math.atan2(e.y,e.x)+Math.PI/2},AnalogTimePicker.prototype.getHourAtAngle_=function(e){return(Math.round(6*e/Math.PI)+12)%12},AnalogTimePicker.prototype.getMinuteAtAngle_=function(e){return this.tapped_?(Math.round(6*e/Math.PI)+12)%12*5:(Math.round(30*e/Math.PI)+60)%60},AnalogTimePicker.prototype.switchToChangeHourMode_=function(){if("analogtimepicker-selected"!=this.$hour_.className&&this.beforeSwitchModeHandler_("hour")!==!1){this.$minute_.className="";var e;for(e=0;e<this.$minuteOptions_.length;e++)this.$minuteOptions_[e].style.display="none";for(e=0;e<this.$hourOptions_.length;e++)this.$hourOptions_[e].style.display="block";this.$hour_.className="analogtimepicker-selected",this.positionClockSelection_(),this.afterSwitchModeHandler_()}},AnalogTimePicker.prototype.switchToChangeMinuteMode_=function(){if("analogtimepicker-selected"!=this.$minute_.className&&this.beforeSwitchModeHandler_("minute")!==!1){this.$hour_.className="";var e;for(e=0;e<this.$hourOptions_.length;e++)this.$hourOptions_[e].style.display="none";for(e=0;e<this.$minuteOptions_.length;e++)this.$minuteOptions_[e].style.display="block";this.$minute_.className="analogtimepicker-selected",this.positionClockSelection_(),this.afterSwitchModeHandler_()}},AnalogTimePicker.prototype.switchMode=function(e){switch(e){case"hour":this.switchToChangeHourMode_();break;case"minute":this.switchToChangeMinuteMode_()}},AnalogTimePicker.prototype.getMode=function(){return"analogtimepicker-selected"==this.$hour_.className?"hour":"minute"},AnalogTimePicker.prototype.setHour=function(e){e>=0&&24>e&&(this.hour_=e,this.$hour_.textContent=this.getDisplayHour_(this.hour_),this.$amPm_.textContent=this.getDisplayAmPm_(this.hour_),this.positionClockSelection_(),this.positionAmPmSelection_())},AnalogTimePicker.prototype.setMinute=function(e){e>=0&&60>e&&(this.minute_=e,this.$minute_.textContent=this.getDisplayMinute_(this.minute_),this.positionClockSelection_())},AnalogTimePicker.prototype.getHour=function(){return this.hour_},AnalogTimePicker.prototype.getMinute=function(){return this.minute_},AnalogTimePicker.prototype.beforeChangeTime=function(e){this.beforeChangeTimeHandler_=e},AnalogTimePicker.prototype.afterChangeTime=function(e){this.afterChangeTimeHandler_=e},AnalogTimePicker.prototype.beforeSwitchMode=function(e){this.beforeSwitchModeHandler_=e},AnalogTimePicker.prototype.afterSwitchMode=function(e){this.afterSwitchModeHandler_=e},AnalogTimePicker.prototype.getDisplayHour=function(){return this.getDisplayHour_(this.hour_)},AnalogTimePicker.prototype.getDisplayMinute=function(){return this.getDisplayMinute_(this.minute_)},AnalogTimePicker.prototype.getDisplayAmPm=function(){return this.getDisplayAmPm_(this.hour_)},function(e){e.fn.analogtimepicker=function(t,i){function o(){var t=e.Event("show.analogtimepicker.popover");$.triggerHandler(t),t.isDefaultPrevented()||(e(".analogtimepicker-popover").not(v.$popover).fadeOut("fast"),v.$popover.fadeIn("fast"),"undefined"==typeof v.picker&&(v.picker=s()),a(),n(),$.triggerHandler("shown.analogtimepicker.popover"),setTimeout(function(){e(document).one("click.analogtimepicker",function(){f(!1)})},0))}function n(){var e,t,i=v.$inputGroup||v.$input,o=i.offset();switch(v.settings.popoverplacement){case"top":e=o.left+(i.outerWidth()-v.$popover.width())/2,t=o.top-v.$popover.outerHeight();break;case"right":e=o.left+i.outerWidth(),t=o.top+(i.outerHeight()-v.$popover.height())/2;break;case"bottom":e=o.left+(i.outerWidth()-v.$popover.width())/2,t=o.top+i.outerHeight();break;case"left":e=o.left-v.$popover.outerWidth(),t=o.top+(i.outerHeight()-v.$popover.height())/2}v.$popover.css("left",e+"px"),v.$popover.css("top",t+"px")}function s(){var t=new AnalogTimePicker(v.$picker[0],v.settings.hour,v.settings.minute);return t.beforeChangeTime(function(t,i){var o=e.Event("pick.analogtimepicker.time",{hour:t,minute:i});return $.triggerHandler(o),!o.isDefaultPrevented()}),t.afterChangeTime(function(){"undefined"!=typeof v.$input&&(r(),v.$input.trigger("change"));var i=e.Event("picked.analogtimepicker.time",{hour:t.getHour(),minute:t.getMinute()});$.triggerHandler(i)}),t.beforeSwitchMode(function(t){var i=e.Event("switch.analogtimepicker.mode",{mode:t});return $.triggerHandler(i),!i.isDefaultPrevented()}),t.afterSwitchMode(function(){var i=e.Event("switched.analogtimepicker.mode",{mode:t.getMode()});$.triggerHandler(i)}),t}function r(){v.$input.val(v.picker.getDisplayHour()+":"+v.picker.getDisplayMinute()+" "+v.picker.getDisplayAmPm())}function a(){if("undefined"!=typeof v.$input){var e=0,t=0,i=/^\s*(\d+)\s*(?::\s*(\d+)\s*)?(\S+)?/.exec(v.$input.val());if(null!==i&&(e=parseInt(i[1]),(0>e||e>=12)&&(e=0),"undefined"!=typeof i[2]&&(t=parseInt(i[2]),(0>t||t>=60)&&(t=0)),"undefined"!=typeof i[3]))switch(i[3].toLowerCase()){case"pm":case"p":e+=12}v.picker.setHour(e),v.picker.setMinute(t)}}function h(){return"undefined"!=typeof v.picker?v.picker.getHour():v.settings.hour}function p(e){"undefined"!=typeof v.picker?v.picker.setHour(e):v.settings.hour=e}function l(){return"undefined"!=typeof v.picker?v.picker.getMinute():v.settings.minute}function c(e){"undefined"!=typeof v.picker?v.picker.setMinute(e):v.settings.minute=e}function u(){return"undefined"!=typeof v.picker?v.picker.getMode():"hour"}function _(e){"undefined"!=typeof v.picker&&v.picker.switchMode(e)}function m(){return v.settings.popoverplacement}function d(e){"undefined"!=typeof v.$popover&&(v.$popover.removeClass(v.settings.popoverplacement),v.$popover.addClass(e)),v.settings.popoverplacement=e,n()}function f(t){if("undefined"!=typeof v.$popover&&t!=v.$popover.is(":visible"))if(t)o();else{var i=e.Event("hide.analogtimepicker.popover");$.triggerHandler(i),i.isDefaultPrevented()||(v.$popover.fadeOut("fast"),$.triggerHandler("hidden.analogtimepicker.popover"))}}function g(){"undefined"!=typeof v.$input?(v.$input.off(k),v.$input.off("click.analogtimepicker"),"undefined"!=typeof v.$inputGroup&&v.$inputGroup.find("button").off("click.analogtimepicker"),e(window).off("resize.analogtimepicker"),e(document).off("click.analogtimepicker"),v.$popover.remove()):v.$picker.empty(),$.removeData("analogtimepicker")}var k="change.analogtimepicker keyup.analogtimepicker paste.analogtimepicker input.analogtimepicker",$=e(this),v=$.data("analogtimepicker");if("undefined"==typeof v){if(v={},v.settings=e.extend({},e.fn.analogtimepicker.defaults,t instanceof Object?t:{},$.data()),"input"==$.prop("tagName").toLowerCase())v.$input=$;else{var y=$.find("input");y.length>0&&(v.$inputGroup=$,v.$input=y.first())}if("undefined"!=typeof v.$input){v.$popover=e('<div class="popover analogtimepicker-popover"><div class="arrow"></div></div>'),v.$popover.addClass(v.settings.popoverplacement),v.$popover.click(function(e){e.stopPropagation()});var C=e("<div>");C.addClass("popover-content"),C.addClass("analogtimepicker-popover-content"),v.$picker=e("<div>"),v.$picker.appendTo(C),C.appendTo(v.$popover),v.$popover.appendTo(e("body")),v.$input.on(k,a),v.$input.on("click.analogtimepicker",function(e){e.stopPropagation(),o()}),"undefined"!=typeof v.$inputGroup&&v.$inputGroup.find("button").on("click.analogtimepicker",function(e){e.stopPropagation(),f(!v.$popover.is(":visible"))}),e(window).on("resize.analogtimepicker",n)}else v.$picker=$,v.picker=s();$.data("analogtimepicker",v)}if("string"==typeof t){var A;switch(t){case"hour":"undefined"==typeof i?A=h():p(i);break;case"minute":"undefined"==typeof i?A=l():c(i);break;case"mode":"undefined"==typeof i?A=u():_(i);break;case"popoverplacement":"undefined"==typeof i?A=m():d(i);break;case"showpopover":f(!0);break;case"hidepopover":f(!1);break;case"destroy":g()}return A}return $},e.fn.analogtimepicker.defaults={hour:0,minute:0,popoverplacement:"bottom"},e(function(){e(".analogtimepicker").each(function(){e(this).analogtimepicker()})})}(jQuery);