function AnalogTimePicker(e){this.hour_=0,this.minute_=0,this.mode_="hour",this.decorate_(e)}AnalogTimePicker.Class={CONTAINER:"analogtimepicker-container",TextPart:{CONTAINER:"analogtimepicker-textpart",HOUR:"analogtimepicker-textpart-hour",HOUR_SELECTED:"analogtimepicker-textpart-hour analogtimepicker-textpart-selected",COLON:"analogtimepicker-textpart-colon",MINUTE:"analogtimepicker-textpart-minute",MINUTE_SELECTED:"analogtimepicker-textpart-minute analogtimepicker-textpart-selected",AMPM:"analogtimepicker-textpart-ampm"},ClockPart:{CONTAINER:"analogtimepicker-clockpart",NUMBER:"analogtimepicker-clockpart-number",CLOCK:"analogtimepicker-clockpart-clock",AMPM:"analogtimepicker-clockpart-ampm",SELECTION:"analogtimepicker-clockpart-selection",HOVER:"analogtimepicker-clockpart-hover"}},AnalogTimePicker.prototype.decorate_=function(e){this.container_=e,this.container_.className+=" "+AnalogTimePicker.Class.CONTAINER,this.tapped_=!1;var t=document.createElement("div");t.className=AnalogTimePicker.Class.TextPart.CONTAINER,this.container_.appendChild(t),this.hourElement_=document.createElement("span"),this.hourElement_.className=AnalogTimePicker.Class.TextPart.HOUR_SELECTED,this.hourElement_.textContent=this.getFormattedHour(),t.appendChild(this.hourElement_),this.hourElement_.style.width=this.hourElement_.offsetWidth+"px";var i=document.createElement("span");i.className=AnalogTimePicker.Class.TextPart.COLON,i.textContent=":",t.appendChild(i),this.minuteElement_=document.createElement("span"),this.minuteElement_.className=AnalogTimePicker.Class.TextPart.MINUTE,this.minuteElement_.textContent=this.getFormattedMinute(),t.appendChild(this.minuteElement_),this.amPmElement_=document.createElement("span"),this.amPmElement_.className=AnalogTimePicker.Class.TextPart.AMPM,this.amPmElement_.textContent=this.getFormattedAmPm(),t.appendChild(this.amPmElement_);var o=document.createElement("div");o.className=AnalogTimePicker.Class.ClockPart.NUMBER,o.textContent=this.formatMinute_(0),this.container_.appendChild(o);var n=o.offsetWidth,r=o.offsetHeight;this.container_.removeChild(o),this.clockPart_=document.createElement("div"),this.clockPart_.className=AnalogTimePicker.Class.ClockPart.CONTAINER,this.clockPart_.style.paddingBottom=.8*r+"px",this.container_.appendChild(this.clockPart_),this.clockCenter_=this.clockPart_.offsetWidth/2,this.clockRadius_=this.clockPart_.offsetWidth/2-n;var a=document.createElement("div");for(a.className=AnalogTimePicker.Class.ClockPart.CLOCK,this.clockPart_.appendChild(a),a.style.height=a.offsetWidth+"px",this.hourOptions_=[],hour=0;12>hour;hour++)o=document.createElement("div"),o.className=AnalogTimePicker.Class.ClockPart.NUMBER,o.textContent=this.formatHour_(hour),this.clockPart_.appendChild(o),this.positionAtAngle_(o,this.getAngleAtHour_(hour)),this.hourOptions_.push(o);for(this.minuteOptions_=[],minute=0;60>minute;minute+=5)o=document.createElement("div"),o.className=AnalogTimePicker.Class.ClockPart.NUMBER,o.textContent=this.formatMinute_(minute),this.clockPart_.appendChild(o),this.positionAtAngle_(o,this.getAngleAtMinute_(minute)),o.style.display="none",this.minuteOptions_.push(o);this.amOption_=document.createElement("div"),this.amOption_.className=AnalogTimePicker.Class.ClockPart.AMPM,this.amOption_.textContent="AM",this.clockPart_.appendChild(this.amOption_),this.amOption_.style.left=this.clockCenter_-this.clockRadius_-n/2+"px",this.amOption_.style.top=this.clockCenter_+this.clockRadius_+r/2+"px",this.pmOption_=document.createElement("div"),this.pmOption_.className=AnalogTimePicker.Class.ClockPart.AMPM,this.pmOption_.textContent="PM",this.clockPart_.appendChild(this.pmOption_),this.pmOption_.style.left=this.clockCenter_+this.clockRadius_-this.pmOption_.offsetWidth+n/2+"px",this.pmOption_.style.top=this.clockCenter_+this.clockRadius_+r/2+"px",this.selectionSize_=Math.max(this.amOption_.offsetWidth,this.amOption_.offsetHeight),this.clockElementSelection_=document.createElement("div"),this.clockElementSelection_.className=AnalogTimePicker.Class.ClockPart.SELECTION,this.clockElementSelection_.style.width=this.selectionSize_+"px",this.clockElementSelection_.style.height=this.selectionSize_+"px",this.clockPart_.appendChild(this.clockElementSelection_),this.positionClockSelection_(),this.hoverSelectionElement_=document.createElement("div"),this.hoverSelectionElement_.className=AnalogTimePicker.Class.ClockPart.HOVER,this.hoverSelectionElement_.style.width=this.selectionSize_/3+"px",this.hoverSelectionElement_.style.height=this.selectionSize_/3+"px",this.hoverSelectionElement_.style.display="none",this.clockPart_.appendChild(this.hoverSelectionElement_),this.amPmSelectionElement_=document.createElement("div"),this.amPmSelectionElement_.className=AnalogTimePicker.Class.ClockPart.SELECTION,this.amPmSelectionElement_.style.width=1.2*this.selectionSize_+"px",this.amPmSelectionElement_.style.height=1.2*this.selectionSize_+"px",this.clockPart_.appendChild(this.amPmSelectionElement_),this.amPmSelectionElement_.style.top=this.amOption_.offsetTop-(1.2*this.selectionSize_-this.amOption_.offsetHeight)/2+"px",this.positionAmPmSelection_(),this.attachEventHandlers_()},AnalogTimePicker.prototype.formatHour_=function(e){var t=e%12;return 0===t?12:t},AnalogTimePicker.prototype.formatMinute_=function(e){return 1==e.toString().length?"0"+e:e},AnalogTimePicker.prototype.formatAmPm_=function(e){return 12>e?"AM":"PM"},AnalogTimePicker.prototype.positionAtAngle_=function(e,t){e.style.left=this.clockCenter_+this.clockRadius_*Math.cos(t)-e.offsetWidth/2+"px",e.style.top=this.clockCenter_+this.clockRadius_*Math.sin(t)-e.offsetHeight/2+"px"},AnalogTimePicker.prototype.getAngleAtHour_=function(e){return e/12*2*Math.PI-Math.PI/2},AnalogTimePicker.prototype.getAngleAtMinute_=function(e){return e/60*2*Math.PI-Math.PI/2},AnalogTimePicker.prototype.positionClockSelection_=function(){var e="hour"==this.mode_?this.getAngleAtHour_(this.hour_):this.getAngleAtMinute_(this.minute_);this.positionAtAngle_(this.clockElementSelection_,e)},AnalogTimePicker.prototype.positionHoverSelection_=function(e){var t="hour"==this.mode_?this.getAngleAtHour_(e):this.getAngleAtMinute_(e);this.positionAtAngle_(this.hoverSelectionElement_,t)},AnalogTimePicker.prototype.positionAmPmSelection_=function(){var e=this.hour_<12?this.amOption_:this.pmOption_;this.amPmSelectionElement_.style.left=e.offsetLeft-(1.2*this.selectionSize_-e.offsetWidth)/2+"px"},AnalogTimePicker.prototype.attachEventHandlers_=function(){var e=this;e.hourElement_.addEventListener("click",function(){e.switchToChangeHourMode_()}),e.minuteElement_.addEventListener("click",function(){e.switchToChangeMinuteMode_()}),e.amPmElement_.addEventListener("click",function(){e.setHour((e.hour_+12)%24)}),e.container_.addEventListener("mousemove",function(t){var i=e.getClockCoordinates_(t);e.handleMouseMove_(i)}),e.container_.addEventListener("click",function(t){var i=e.getClockCoordinates_(t);e.handleMouseUp_(i)}),e.container_.addEventListener("touchstart",function(t){var i=e.getClockCoordinates_(t.touches[0]);if(e.isOverClockOption_(i)){t.preventDefault(),e.tapped_=!0;var o=function(t){document.removeEventListener("touchend",o);var i=e.getClockCoordinates_(t.changedTouches[0]);e.handleMouseUp_(i),e.tapped_=!1};document.addEventListener("touchend",o)}}),e.container_.addEventListener("touchmove",function(t){e.tapped_=!1;var i=e.getClockCoordinates_(t.touches[0]);e.handleMouseMove_(i)}),e.amOption_.addEventListener("click",function(){e.setHour(e.hour_-12)}),e.pmOption_.addEventListener("click",function(){e.setHour(e.hour_+12)})},AnalogTimePicker.prototype.handleMouseMove_=function(e){if(this.isOverClockOption_(e)){var t=this.getAngleAtCoordinates_(e);if("hour"==this.mode_){var i=this.getHourAtAngle_(t);this.hourElement_.textContent=this.formatHour_(i),this.positionHoverSelection_(i)}else{var o=this.getMinuteAtAngle_(t);this.minuteElement_.textContent=this.formatMinute_(o),this.positionHoverSelection_(o)}this.hoverSelectionElement_.style.display="block",this.container_.style.cursor="pointer"}else"hour"==this.mode_?this.hourElement_.textContent=this.formatHour_(this.hour_):this.minuteElement_.textContent=this.formatMinute_(this.minute_),this.hoverSelectionElement_.style.display="none",this.container_.style.cursor="auto"},AnalogTimePicker.prototype.handleMouseUp_=function(e){if(this.isOverClockOption_(e)){var t=this.getAngleAtCoordinates_(e);"hour"==this.mode_?(this.setHour(12*Math.floor(this.hour_/12)+this.getHourAtAngle_(t)),this.switchToChangeMinuteMode_()):this.setMinute(this.getMinuteAtAngle_(t)),this.hoverSelectionElement_.style.display="none"}},AnalogTimePicker.prototype.getClockCoordinates_=function(e){var t=this.clockPart_.getBoundingClientRect(),i=t.left+document.body.scrollLeft,o=t.top+document.body.scrollTop;return{x:e.pageX-i-this.clockCenter_,y:e.pageY-o-this.clockCenter_}},AnalogTimePicker.prototype.isOverClockOption_=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return Math.abs(t-this.clockRadius_)<this.selectionSize_/2},AnalogTimePicker.prototype.getAngleAtCoordinates_=function(e){return Math.atan2(e.y,e.x)+Math.PI/2},AnalogTimePicker.prototype.getHourAtAngle_=function(e){return(Math.round(6*e/Math.PI)+12)%12},AnalogTimePicker.prototype.getMinuteAtAngle_=function(e){return this.tapped_?(Math.round(6*e/Math.PI)+12)%12*5:(Math.round(30*e/Math.PI)+60)%60},AnalogTimePicker.prototype.switchToChangeHourMode_=function(){this.mode_="hour",this.minuteElement_.className=AnalogTimePicker.Class.TextPart.HOUR;var e;for(e=0;e<this.minuteOptions_.length;e++)this.minuteOptions_[e].style.display="none";for(e=0;e<this.hourOptions_.length;e++)this.hourOptions_[e].style.display="block";this.hourElement_.className=AnalogTimePicker.Class.TextPart.HOUR_SELECTED,this.positionClockSelection_(),this.triggerEvent_("modechange")},AnalogTimePicker.prototype.switchToChangeMinuteMode_=function(){this.mode_="minute",this.hourElement_.className=AnalogTimePicker.Class.TextPart.MINUTE;var e;for(e=0;e<this.hourOptions_.length;e++)this.hourOptions_[e].style.display="none";for(e=0;e<this.minuteOptions_.length;e++)this.minuteOptions_[e].style.display="block";this.minuteElement_.className=AnalogTimePicker.Class.TextPart.MINUTE_SELECTED,this.positionClockSelection_()},AnalogTimePicker.prototype.triggerEvent_=function(e){var t=document.createEvent("Event");t.initEvent(e,!0,!0),this.container_.dispatchEvent(t)},AnalogTimePicker.prototype.switchMode=function(e){if(this.mode!=e)switch(e){case"hour":this.switchToChangeHourMode_(),this.triggerEvent_("modechange");break;case"minute":this.switchToChangeMinuteMode_(),this.triggerEvent_("modechange")}},AnalogTimePicker.prototype.getMode=function(){return this.mode_},AnalogTimePicker.prototype.setHour=function(e){this.hour_!=e&&e>=0&&24>e&&(this.hour_=e,this.hourElement_.textContent=this.formatHour_(this.hour_),this.amPmElement_.textContent=this.formatAmPm_(this.hour_),this.positionClockSelection_(),this.positionAmPmSelection_(),this.triggerEvent_("timechange"))},AnalogTimePicker.prototype.setMinute=function(e){this.minute_!=e&&e>=0&&60>e&&(this.minute_=e,this.minuteElement_.textContent=this.formatMinute_(this.minute_),this.positionClockSelection_(),this.triggerEvent_("timechange"))},AnalogTimePicker.prototype.getHour=function(){return this.hour_},AnalogTimePicker.prototype.getMinute=function(){return this.minute_},AnalogTimePicker.prototype.getFormattedHour=function(){return this.formatHour_(this.hour_)},AnalogTimePicker.prototype.getFormattedMinute=function(){return this.formatMinute_(this.minute_)},AnalogTimePicker.prototype.getFormattedAmPm=function(){return this.formatAmPm_(this.hour_)},function(e){e.fn.analogtimepicker=function(t,i){function o(){var t=e.Event("show.analogtimepicker.popover");v.triggerHandler(t),t.isDefaultPrevented()||(e(".analogtimepicker-popover").not(C.$popover).fadeOut("fast"),C.$popover.fadeIn("fast"),"undefined"==typeof C.picker&&(C.picker=r()),s(),n(),v.triggerHandler("shown.analogtimepicker.popover"),setTimeout(function(){e(document).one("click.analogtimepicker",function(){g(!1)})},0))}function n(){var e,t,i=C.$inputGroup||C.$input,o=i.offset();switch(C.settings.popoverplacement){case"top":e=o.left+(i.outerWidth()-C.$popover.width())/2,t=o.top-C.$popover.outerHeight();break;case"right":e=o.left+i.outerWidth(),t=o.top+(i.outerHeight()-C.$popover.height())/2;break;case"bottom":e=o.left+(i.outerWidth()-C.$popover.width())/2,t=o.top+i.outerHeight();break;case"left":e=o.left-C.$popover.outerWidth(),t=o.top+(i.outerHeight()-C.$popover.height())/2}C.$popover.css("left",e+"px"),C.$popover.css("top",t+"px")}function r(){var t=new AnalogTimePicker(C.$picker[0]);return t.setHour(C.settings.hour),t.setMinute(C.settings.minute),C.$picker.on("timechange",function(){"undefined"!=typeof C.$input&&(a(),C.$input.trigger("change"));var i=e.Event("picked.analogtimepicker.time",{hour:t.getHour(),minute:t.getMinute()});v.triggerHandler(i)}),C.$picker.on("modechange",function(){var i=e.Event("switched.analogtimepicker.mode",{mode:t.getMode()});v.triggerHandler(i)}),t}function a(){C.$input.val(C.picker.getFormattedHour()+":"+C.picker.getFormattedMinute()+" "+C.picker.getFormattedAmPm())}function s(){if("undefined"!=typeof C.$input){var e=0,t=0,i=/^\s*(\d+)\s*(?::\s*(\d+)\s*)?(\S+)?/.exec(C.$input.val());if(null!==i&&(e=parseInt(i[1]),(0>e||e>=12)&&(e=0),"undefined"!=typeof i[2]&&(t=parseInt(i[2]),(0>t||t>=60)&&(t=0)),"undefined"!=typeof i[3]))switch(i[3].toLowerCase()){case"pm":case"p":e+=12}C.picker.setHour(e),C.picker.setMinute(t)}}function c(){return"undefined"!=typeof C.picker?C.picker.getHour():C.settings.hour}function l(e){"undefined"!=typeof C.picker?C.picker.setHour(e):C.settings.hour=e}function p(){return"undefined"!=typeof C.picker?C.picker.getMinute():C.settings.minute}function h(e){"undefined"!=typeof C.picker?C.picker.setMinute(e):C.settings.minute=e}function m(){return"undefined"!=typeof C.picker?C.picker.getMode():"hour"}function u(e){"undefined"!=typeof C.picker&&C.picker.switchMode(e)}function d(){return C.settings.popoverplacement}function _(e){"undefined"!=typeof C.$popover&&(C.$popover.removeClass(C.settings.popoverplacement),C.$popover.addClass(e)),C.settings.popoverplacement=e,n()}function g(t){if("undefined"!=typeof C.$popover&&t!=C.$popover.is(":visible"))if(t)o();else{var i=e.Event("hide.analogtimepicker.popover");v.triggerHandler(i),i.isDefaultPrevented()||(C.$popover.fadeOut("fast"),v.triggerHandler("hidden.analogtimepicker.popover"))}}function k(){"undefined"!=typeof C.$input?(C.$input.off(f),C.$input.off("click.analogtimepicker"),"undefined"!=typeof C.$inputGroup&&C.$inputGroup.find("button").off("click.analogtimepicker"),e(window).off("resize.analogtimepicker"),e(document).off("click.analogtimepicker"),C.$popover.remove()):C.$picker.empty(),v.removeData("analogtimepicker")}var f="change.analogtimepicker keyup.analogtimepicker paste.analogtimepicker input.analogtimepicker",v=e(this),C=v.data("analogtimepicker");if("undefined"==typeof C){if(C={},C.settings=e.extend({},e.fn.analogtimepicker.defaults,t instanceof Object?t:{},v.data()),"input"==v.prop("tagName").toLowerCase())C.$input=v;else{var E=v.find("input");E.length>0&&(C.$inputGroup=v,C.$input=E.first())}if("undefined"!=typeof C.$input){C.$popover=e('<div class="popover analogtimepicker-popover"><div class="arrow"></div></div>'),C.$popover.addClass(C.settings.popoverplacement),C.$popover.click(function(e){e.stopPropagation()});var P=e("<div>");P.addClass("popover-content"),P.addClass("analogtimepicker-popover-content"),C.$picker=e("<div>"),C.$picker.appendTo(P),P.appendTo(C.$popover),C.$popover.appendTo(e("body")),C.$input.on(f,s),C.$input.on("click.analogtimepicker",function(e){e.stopPropagation(),o()}),"undefined"!=typeof C.$inputGroup&&C.$inputGroup.find("button").on("click.analogtimepicker",function(e){e.stopPropagation(),g(!C.$popover.is(":visible"))}),e(window).on("resize.analogtimepicker",n)}else C.$picker=v,C.picker=r();v.data("analogtimepicker",C)}if("string"==typeof t){var A;switch(t){case"hour":"undefined"==typeof i?A=c():l(i);break;case"minute":"undefined"==typeof i?A=p():h(i);break;case"mode":"undefined"==typeof i?A=m():u(i);break;case"popoverplacement":"undefined"==typeof i?A=d():_(i);break;case"showpopover":g(!0);break;case"hidepopover":g(!1);break;case"destroy":k()}return A}return v},e.fn.analogtimepicker.defaults={hour:0,minute:0,popoverplacement:"bottom"},e(function(){e(".analogtimepicker").each(function(){e(this).analogtimepicker()})})}(jQuery);