function AnalogTimePicker(t){this.hour_=0,this.minute_=0,this.mode_="hour",this.tapped_=!1,"INPUT"==t.tagName?(this.popup_=document.createElement("div"),this.popup_.className="analogtimepicker-popup",document.body.appendChild(this.popup_),this.container_=document.createElement("div"),this.popup_.appendChild(this.container_),this.setupContainer_(),this.popup_.style.display="none",this.input_=t):(this.container_=t,this.setupContainer_()),this.addEventListeners_(),this.tapped_=!1}AnalogTimePicker.SEPARATOR=":",AnalogTimePicker.AM="AM",AnalogTimePicker.PM="PM",AnalogTimePicker.prototype.setupContainer_=function(){this.container_.className+=" analogtimepicker-container";var t=document.createElement("div");t.className="analogtimepicker-text",this.container_.appendChild(t),this.hourElement_=document.createElement("span"),this.hourElement_.className="analogtimepicker-hour",this.hourElement_.textContent=this.getFormattedHour_(0),t.appendChild(this.hourElement_),this.hourElement_.style.width=this.hourElement_.offsetWidth+"px";var e=document.createElement("span");e.className="analogtimepicker-separator",e.textContent=AnalogTimePicker.SEPARATOR,t.appendChild(e),this.minuteElement_=document.createElement("span"),this.minuteElement_.className="analogtimepicker-minute",this.minuteElement_.textContent=this.getFormattedMinute_(0),t.appendChild(this.minuteElement_),this.period_=document.createElement("span"),this.period_.className="analogtimepicker-period",this.period_.textContent=this.getFormattedPeriod_(0),t.appendChild(this.period_),this.clock_=document.createElement("div"),this.clock_.className="analogtimepicker-clock",this.container_.appendChild(this.clock_);var i=document.createElement("div");i.className="analogtimepicker-number",i.textContent=this.getFormattedMinute_(0),this.container_.appendChild(i),this.numberWidth_=i.offsetWidth,this.clockCenter_=this.clock_.offsetWidth/2,this.numberRadius_=this.clock_.offsetWidth/2-this.numberWidth_,this.container_.removeChild(i);var n=document.createElement("div");n.className="analogtimepicker-face",this.clock_.appendChild(n),n.style.height=n.offsetWidth+"px",this.marker_=document.createElement("div"),this.marker_.className="analogtimepicker-marker",this.clock_.appendChild(this.marker_),this.positionClockElement_(this.marker_,"hour",this.hour_),this.hours_=[];for(var o=0;12>o;o++)i=document.createElement("div"),i.className="analogtimepicker-number",i.textContent=this.getFormattedHour_(o),this.clock_.appendChild(i),this.positionClockElement_(i,"hour",o),this.hours_.push(i);this.minutes_=[];for(var s=0;60>s;s+=5)i=document.createElement("div"),i.className="analogtimepicker-number",i.textContent=this.getFormattedMinute_(s),this.clock_.appendChild(i),this.positionClockElement_(i,"minute",s),this.minutes_.push(i);this.am_=document.createElement("div"),this.am_.className="analogtimepicker-am",this.clock_.appendChild(this.am_);var r=document.createElement("span");r.className="analogtimepicker-periodtext",r.textContent=AnalogTimePicker.AM,this.am_.appendChild(r),r.style.height=r.offsetWidth+"px",this.pm_=document.createElement("div"),this.pm_.className="analogtimepicker-pm",this.clock_.appendChild(this.pm_);var a=document.createElement("span");a.className="analogtimepicker-periodtext",a.textContent=AnalogTimePicker.PM,this.pm_.appendChild(a),a.style.height=a.offsetWidth+"px",this.hover_=document.createElement("div"),this.hover_.className="analogtimepicker-hover",this.hover_.style.visibility="hidden",this.clock_.appendChild(this.hover_),this.refresh_()},AnalogTimePicker.prototype.refresh_=function(){this.hourElement_.textContent=this.getFormattedHour_(this.hour_),this.hourElement_.className="analogtimepicker-hour","hour"==this.mode_&&(this.hourElement_.className+=" analogtimepicker-active",this.positionClockElement_(this.marker_,"hour",this.hour_)),this.minuteElement_.textContent=this.getFormattedMinute_(this.minute_),this.minuteElement_.className="analogtimepicker-minute","minute"==this.mode_&&(this.minuteElement_.className+=" analogtimepicker-active",this.positionClockElement_(this.marker_,"minute",this.minute_)),this.period_.textContent=this.getFormattedPeriod_(this.hour_);for(var t=0;t<this.hours_.length;t++){var e=this.hours_[t];e.style.visibility="hour"==this.mode_?"visible":"hidden"}for(t=0;t<this.minutes_.length;t++){var i=this.minutes_[t];i.style.visibility="minute"==this.mode_?"visible":"hidden"}this.am_.className="analogtimepicker-am",this.hour_<12&&(this.am_.className+=" analogtimepicker-active"),this.pm_.className="analogtimepicker-pm",this.hour_>=12&&(this.pm_.className+=" analogtimepicker-active")},AnalogTimePicker.prototype.getFormattedHour_=function(t){var e=t%12;return 0===e?12:e},AnalogTimePicker.prototype.getFormattedMinute_=function(t){return 1==t.toString().length?"0"+t:t},AnalogTimePicker.prototype.getFormattedPeriod_=function(t){return 12>t?AnalogTimePicker.AM:AnalogTimePicker.PM},AnalogTimePicker.prototype.positionClockElement_=function(t,e,i){var n=i/("hour"==e?6:30)*Math.PI-Math.PI/2,o=this.numberRadius_*Math.cos(n),s=this.numberRadius_*Math.sin(n);t.style.left=this.clockCenter_+o-t.offsetWidth/2+"px",t.style.top=this.clockCenter_+s-t.offsetHeight/2+"px"},AnalogTimePicker.prototype.addEventListeners_=function(){var t=this;if(t.hourElement_.addEventListener("click",function(){t.setMode("hour",!0)}),t.minuteElement_.addEventListener("click",function(){t.setMode("minute",!0)}),t.period_.addEventListener("click",function(){t.setHour((t.hour_+12)%24,!0)}),t.clock_.addEventListener("mousemove",function(e){t.handleMouseMove_(t.getClockPosition_(e))}),t.clock_.addEventListener("click",function(e){t.handleMouseUp_(t.getClockPosition_(e))}),t.clock_.addEventListener("touchstart",function(e){var i=t.getClockPosition_(e.touches[0]);if(t.mouseIsOverNumber_(i)){e.preventDefault(),t.tapped_=!0;var n=function(e){document.removeEventListener("touchend",n);var i=t.getClockPosition_(e.changedTouches[0]);t.handleMouseUp_(i),t.tapped_=!1};document.addEventListener("touchend",n)}}),t.clock_.addEventListener("touchmove",function(e){t.tapped_=!1,t.handleMouseMove_(t.getClockPosition_(e.touches[0]))}),t.am_.addEventListener("click",function(){t.setHour(t.hour_-12,!0)}),t.pm_.addEventListener("click",function(){t.setHour(t.hour_+12,!0)}),t.input_){for(var e=["change","keyup","paste","input"],i=function(){t.syncWithInput_()},n=0;n<e.length;n++)t.input_.addEventListener(e[n],i);t.input_.addEventListener("click",function(){t.showPopup_()})}},AnalogTimePicker.prototype.getClockPosition_=function(t){var e=this.clock_.getBoundingClientRect(),i=e.left+document.body.scrollLeft,n=e.top+document.body.scrollTop,o=t.pageX-i-this.clockCenter_,s=t.pageY-n-this.clockCenter_;return{radius:Math.sqrt(o*o+s*s),angle:Math.atan2(s,o)+Math.PI/2}},AnalogTimePicker.prototype.handleMouseMove_=function(t){if(this.mouseIsOverNumber_(t)){var e=this.getAngleValue_(t.angle);"hour"==this.mode_?(this.hourElement_.textContent=this.getFormattedHour_(e),this.positionClockElement_(this.hover_,"hour",e)):(this.minuteElement_.textContent=this.getFormattedMinute_(e),this.positionClockElement_(this.hover_,"minute",e)),this.hover_.style.visibility="visible",this.clock_.style.cursor="pointer"}else this.refresh_(),this.hover_.style.visibility="hidden",this.clock_.style.cursor="auto"},AnalogTimePicker.prototype.handleMouseUp_=function(t){if(this.mouseIsOverNumber_(t)){var e=this.getAngleValue_(t.angle);"hour"==this.mode_?(this.setHour(12*Math.floor(this.hour_/12)+e,!0),this.setMode("minute",!0)):this.setMinute(e,!0),this.hover_.style.visibility="hidden"}},AnalogTimePicker.prototype.mouseIsOverNumber_=function(t){return Math.abs(t.radius-this.numberRadius_)<this.numberWidth_},AnalogTimePicker.prototype.getAngleValue_=function(t){return"hour"==this.mode_?(Math.round(6*t/Math.PI)+12)%12:this.tapped_?(Math.round(6*t/Math.PI)+12)%12*5:(Math.round(30*t/Math.PI)+60)%60},AnalogTimePicker.prototype.showPopup_=function(){var t=this.input_.getBoundingClientRect(),e=t.left+document.body.scrollLeft,i=t.top+document.body.scrollTop;this.popup_.style.left=e+"px",this.popup_.style.top=i+this.input_.offsetHeight+"px",this.popup_.style.display="block";var n=function(t){this.container_.contains(t.target)||(document.body.removeEventListener("click",n),this.popup_.style.display="none")}.bind(this);document.body.addEventListener("click",n,!0)},AnalogTimePicker.prototype.syncWithInput_=function(){var t=new RegExp("^\\s*(0?[0-9]|1[0-2])\\"+AnalogTimePicker.SEPARATOR+"([0-5][0-9])\\s*("+AnalogTimePicker.AM+"|"+AnalogTimePicker.PM+")\\s*$","i"),e=t.exec(this.input_.value);if(e){var i=parseInt(e[1]),n=parseInt(e[2]);e[3].toLowerCase()==AnalogTimePicker.PM.toLowerCase()&&(i+=12),(i!=this.hour_||n!=this.minute_)&&(this.setHour(i,!1,!0),this.setMinute(n,!1,!0),this.triggerEvent_("timechange"))}},AnalogTimePicker.prototype.setMode=function(t,e){this.mode_==t||"hour"!=t&&"minute"!=t||(this.mode_=t,this.refresh_(),e&&this.triggerEvent_("modechange"))},AnalogTimePicker.prototype.getMode=function(){return this.mode_},AnalogTimePicker.prototype.setHour=function(t,e,i){this.hour_!=t&&t>=0&&24>t&&(this.hour_=t,this.refresh_(),!i&&this.input_&&this.updateInput_(),e&&this.triggerEvent_("timechange"))},AnalogTimePicker.prototype.getHour=function(){return this.hour_},AnalogTimePicker.prototype.setMinute=function(t,e,i){this.minute_!=t&&t>=0&&60>t&&(this.minute_=t,this.refresh_(),!i&&this.input_&&this.updateInput_(),e&&this.triggerEvent_("timechange"))},AnalogTimePicker.prototype.getMinute=function(){return this.minute_},AnalogTimePicker.prototype.triggerEvent_=function(t){var e=document.createEvent("Event");e.initEvent(t,!0,!0),this.container_.dispatchEvent(e)},AnalogTimePicker.prototype.updateInput_=function(){var t=this.getFormattedHour_(this.hour_),e=this.getFormattedMinute_(this.minute_),i=this.getFormattedPeriod_(this.hour_);this.input_.value=t+AnalogTimePicker.SEPARATOR+e+" "+i};